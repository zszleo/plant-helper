<!--pages/records/records.wxml-->
<!-- ç­›é€‰å™¨ -->
<view class="filter-bar">
    <scroll-view class="filter-scroll" scroll-x="true" show-scrollbar="false">
      <view 
        class="filter-item {{selectedType === '' ? 'active' : ''}}" 
        bindtap="onFilterChange" 
        data-type=""
      >
        å…¨éƒ¨
      </view>
      <view 
        class="filter-item {{selectedType === 'watering' ? 'active' : ''}}" 
        bindtap="onFilterChange" 
        data-type="watering"
      >
        æµ‡æ°´
      </view>
      <view 
        class="filter-item {{selectedType === 'fertilizing' ? 'active' : ''}}" 
        bindtap="onFilterChange" 
        data-type="fertilizing"
      >
        æ–½è‚¥
      </view>
      <view 
        class="filter-item {{selectedType === 'growth' ? 'active' : ''}}" 
        bindtap="onFilterChange" 
        data-type="growth"
      >
        ç”Ÿé•¿
      </view>
      <view 
        class="filter-item {{selectedType === 'photo' ? 'active' : ''}}" 
        bindtap="onFilterChange" 
        data-type="photo"
      >
        ç…§ç‰‡
      </view>
    </scroll-view>
</view>

<scroll-view class="container {{pageAnimationClass}}" scroll-y="{{true}}" show-scrollbar="{{true}}" bindtouchstart="onTouchStart" bindtouchend="onTouchEnd" bindscrolltolower="onReachBottom">
  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="records-list">
    <view class="date-group" wx:for="{{groupedRecords}}" wx:key="date">
      <view class="date-header">
        <text class="date-text">{{item.date}}</text>
        <text class="date-count">{{item.records.length}}æ¡è®°å½•</text>
      </view>

      <view class="record-card" wx:for="{{item.records}}" wx:for-item="record" wx:key="_id" bindtap="onRecordDetail" data-id="{{record._id}}">
        <view class="card-header">
          <view class="card-icon-wrapper">
            <image class="card-icon" wx:if="{{record.plantImage}}" src="{{record.plantImage}}" mode="aspectFill"></image>
            <view class="card-icon-placeholder" wx:else>
              <text class="placeholder-icon">ğŸŒ±</text>
            </view>
          </view>
          <view class="card-title-wrapper">
            <text class="card-title">{{record.plantName}}</text>
            <view class="card-subtitle">
              <text class="record-type">{{record.recordTitle}}</text>
              <text class="dot">Â·</text>
              <text class="record-time">{{record.formattedTime}}</text>
            </view>
          </view>
          <image class="card-arrow" src="/images/arrow-right.svg" mode="aspectFit"></image>
        </view>
        <view class="card-note" wx:if="{{record.notes}}">
          <text class="note-text">{{record.notes}}</text>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤šæç¤º -->
    <view class="load-more" wx:if="{{filteredRecords.length > 0}}">
      <text class="load-more-text" wx:if="{{isLoading}}">åŠ è½½ä¸­...</text>
      <text class="load-more-text" wx:elif="{{!hasMore}}">æ²¡æœ‰æ›´å¤šäº†</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{filteredRecords.length === 0}}">
      <image class="empty-icon" src="/images/empty-records.svg" mode="aspectFit"></image>
      <text class="empty-text">è¿˜æ²¡æœ‰è®°å½•</text>
      <text class="empty-hint">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€æ¡è®°å½•</text>
    </view>
  </view>
</scroll-view>

<!-- æ·»åŠ æŒ‰é’® -->
<view class="add-btn" bindtap="onAddRecord">
  <image class="add-icon" src="/images/add.svg" mode="aspectFit"></image>
</view>
